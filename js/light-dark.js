function setTheme() {
    const cookies = document.cookie.split(";");
    if(cookies.filter(c => c.match("theme=dark")).length > 0) {
        document.body.classList.add("night-mode");
    } else if (cookies.filter(c => c.match("theme=light")).length > 0) {
        document.body.classList.remove("night-mode");
    } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add("night-mode");
    }
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
        if(event.matches) {
            document.body.classList.add("night-mode");
        } else {
            document.body.classList.remove("night-mode");
        }
    });
}

document.addEventListener("DOMContentLoaded", () => {
    const wrapper = document.createElement("div");
    wrapper.classList.add("center");
    wrapper.id = "day-theme";
    wrapper.tabIndex = "0";         

    const daySVG = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    daySVG.id = "sun-icon";
    daySVG.setAttributeNS(null, "viewBox", "0 0 240 240");

    const dayPath = document.createElementNS("http://www.w3.org/2000/svg", "path");
    dayPath.setAttributeNS(null, "d", "M58.57,25.81c-2.13-3.67-0.87-8.38,2.8-10.51c3.67-2.13,8.38-0.88,10.51,2.8l9.88,17.1c2.13,3.67,0.87,8.38-2.8,10.51 c-3.67,2.13-8.38,0.88-10.51-2.8L58.57,25.81L58.57,25.81z M120,51.17c19.01,0,36.21,7.7,48.67,20.16 C181.12,83.79,188.83,101,188.83,120c0,19.01-7.7,36.21-20.16,48.67c-12.46,12.46-29.66,20.16-48.67,20.16 c-19.01,0-36.21-7.7-48.67-20.16C58.88,156.21,51.17,139.01,51.17,120c0-19.01,7.7-36.21,20.16-48.67 C83.79,58.88,101,51.17,120,51.17L120,51.17z M158.27,81.73c-9.79-9.79-23.32-15.85-38.27-15.85c-14.95,0-28.48,6.06-38.27,15.85 c-9.79,9.79-15.85,23.32-15.85,38.27c0,14.95,6.06,28.48,15.85,38.27c9.79,9.79,23.32,15.85,38.27,15.85 c14.95,0,28.48-6.06,38.27-15.85c9.79-9.79,15.85-23.32,15.85-38.27C174.12,105.05,168.06,91.52,158.27,81.73L158.27,81.73z M113.88,7.71c0-4.26,3.45-7.71,7.71-7.71c4.26,0,7.71,3.45,7.71,7.71v19.75c0,4.26-3.45,7.71-7.71,7.71 c-4.26,0-7.71-3.45-7.71-7.71V7.71L113.88,7.71z M170.87,19.72c2.11-3.67,6.8-4.94,10.48-2.83c3.67,2.11,4.94,6.8,2.83,10.48 l-9.88,17.1c-2.11,3.67-6.8,4.94-10.48,2.83c-3.67-2.11-4.94-6.8-2.83-10.48L170.87,19.72L170.87,19.72z M214.19,58.57 c3.67-2.13,8.38-0.87,10.51,2.8c2.13,3.67,0.88,8.38-2.8,10.51l-17.1,9.88c-3.67,2.13-8.38,0.87-10.51-2.8 c-2.13-3.67-0.88-8.38,2.8-10.51L214.19,58.57L214.19,58.57z M232.29,113.88c4.26,0,7.71,3.45,7.71,7.71 c0,4.26-3.45,7.71-7.71,7.71h-19.75c-4.26,0-7.71-3.45-7.71-7.71c0-4.26,3.45-7.71,7.71-7.71H232.29L232.29,113.88z M220.28,170.87 c3.67,2.11,4.94,6.8,2.83,10.48c-2.11,3.67-6.8,4.94-10.48,2.83l-17.1-9.88c-3.67-2.11-4.94-6.8-2.83-10.48 c2.11-3.67,6.8-4.94,10.48-2.83L220.28,170.87L220.28,170.87z M181.43,214.19c2.13,3.67,0.87,8.38-2.8,10.51 c-3.67,2.13-8.38,0.88-10.51-2.8l-9.88-17.1c-2.13-3.67-0.87-8.38,2.8-10.51c3.67-2.13,8.38-0.88,10.51,2.8L181.43,214.19 L181.43,214.19z M126.12,232.29c0,4.26-3.45,7.71-7.71,7.71c-4.26,0-7.71-3.45-7.71-7.71v-19.75c0-4.26,3.45-7.71,7.71-7.71 c4.26,0,7.71,3.45,7.71,7.71V232.29L126.12,232.29z M69.13,220.28c-2.11,3.67-6.8,4.94-10.48,2.83c-3.67-2.11-4.94-6.8-2.83-10.48 l9.88-17.1c2.11-3.67,6.8-4.94,10.48-2.83c3.67,2.11,4.94,6.8,2.83,10.48L69.13,220.28L69.13,220.28z M25.81,181.43 c-3.67,2.13-8.38,0.87-10.51-2.8c-2.13-3.67-0.88-8.38,2.8-10.51l17.1-9.88c3.67-2.13,8.38-0.87,10.51,2.8 c2.13,3.67,0.88,8.38-2.8,10.51L25.81,181.43L25.81,181.43z M7.71,126.12c-4.26,0-7.71-3.45-7.71-7.71c0-4.26,3.45-7.71,7.71-7.71 h19.75c4.26,0,7.71,3.45,7.71,7.71c0,4.26-3.45,7.71-7.71,7.71H7.71L7.71,126.12z M19.72,69.13c-3.67-2.11-4.94-6.8-2.83-10.48 c2.11-3.67,6.8-4.94,10.48-2.83l17.1,9.88c3.67,2.11,4.94,6.8,2.83,10.48c-2.11,3.67-6.8,4.94-10.48,2.83L19.72,69.13L19.72,69.13z");
    daySVG.appendChild(dayPath);

    const nightSVG = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    nightSVG.id = "moon-icon";
    nightSVG.setAttributeNS(null, "viewBox", "0 0 120 120");
    
    const nightPath = document.createElementNS("http://www.w3.org/2000/svg", "path");
    nightPath.setAttributeNS(null, "d", "M61.98,32.36c0,0.23-0.03,0.45-0.09,0.65c5.77,2.79,10.79,7.4,14.05,13.89c1.32-0.21,2.64-0.31,3.95-0.3 c5.54,0.04,10.89,2.02,15.11,6.56c0.88,0.95,1.72,2.02,2.5,3.22c0.69,1.06,1.29,2.21,1.8,3.43c4.18-1.3,7.96-3.54,11.08-6.46 c2.21-2.07,4.09-4.49,5.56-7.16c-0.79,0.35-1.6,0.67-2.42,0.95c-2.99,1.03-6.19,1.58-9.52,1.58c-8.1,0-15.43-3.28-20.73-8.59 c-5.31-5.31-8.59-12.64-8.59-20.73c0-3.46,0.6-6.78,1.7-9.86c0.33-0.93,0.71-1.85,1.14-2.74c-3.72,1.92-6.96,4.64-9.51,7.92 C64.23,19.59,61.98,25.71,61.98,32.36L61.98,32.36z M57.44,31.26c0.23-7.27,2.8-13.96,6.98-19.33C68.89,6.17,75.23,1.92,82.53,0.07 c1.22-0.31,2.46,0.44,2.76,1.66c0.19,0.78-0.04,1.56-0.54,2.11c-1.73,2.14-3.12,4.58-4.07,7.25c-0.93,2.6-1.43,5.4-1.43,8.33 c0,6.84,2.77,13.03,7.25,17.51c4.48,4.48,10.67,7.25,17.51,7.25c2.82,0,5.52-0.47,8.04-1.33c2.63-0.9,5.04-2.22,7.17-3.88 c0.99-0.77,2.42-0.6,3.19,0.39c0.46,0.59,0.58,1.34,0.4,2.01l0,0c-1.66,5.94-4.93,11.21-9.31,15.3c-3.61,3.38-7.98,5.97-12.82,7.48 c0.52,2.28,0.78,4.66,0.75,7.02c-0.06,5.21-1.46,10.39-4.33,14.21c-1,1.34-2.9,1.61-4.24,0.61c-1.34-1-1.61-2.9-0.61-4.24 c2.06-2.75,3.08-6.63,3.12-10.62c0.05-4.18-0.97-8.38-2.96-11.44c-0.57-0.88-1.19-1.67-1.86-2.39c-2.98-3.21-6.76-4.61-10.69-4.64 c-2.85-0.02-5.79,0.67-8.59,1.9c-0.62,0.31-1.24,0.64-1.86,1c-1.86,1.09-3.69,2.42-5.56,3.95l-3.99-4.57 c1.38-1.28,2.88-2.44,4.46-3.48c1.27-0.82,2.58-1.56,3.94-2.19c0.54-0.27,1.09-0.53,1.65-0.77c-2.63-4.66-6.42-8.01-10.72-10.07 c-4.29-2.06-9.1-2.85-13.78-2.4c-4.65,0.45-9.16,2.14-12.89,5.03c-4.31,3.35-7.6,8.35-8.85,14.97l-0.39,2.07l-2.07,0.36 c-2.02,0.35-3.83,0.84-5.41,1.46c-1.54,0.6-2.9,1.33-4.1,2.2c-0.96,0.69-1.78,1.47-2.49,2.31c-2.17,2.6-3.18,5.86-3.16,9.16 c0.02,3.35,1.12,6.73,3.13,9.52c0.75,1.03,1.62,1.98,2.61,2.81c1.29,1.08,1.46,2.99,0.38,4.28c-1.08,1.29-2.99,1.46-4.28,0.38 c-1.38-1.16-2.6-2.47-3.63-3.9C1.52,82.89,0.03,78.25,0,73.63c-0.03-4.67,1.42-9.32,4.56-13.08c1.02-1.22,2.21-2.34,3.58-3.33 c1.6-1.15,3.42-2.13,5.48-2.93c1.42-0.55,2.94-1.01,4.54-1.38c1.81-7.21,5.69-12.77,10.66-16.63c4.65-3.61,10.26-5.71,16.03-6.27 C49.06,29.6,53.35,30.01,57.44,31.26L57.44,31.26z M26.63,89.31c-1.23,0-2.22-1.36-2.22-3.04c0-1.68,0.99-3.04,2.22-3.04h54.94 c1.23,0,2.22,1.36,2.22,3.04c0,1.68-0.99,3.04-2.22,3.04H26.63L26.63,89.31z M16.83,102.11c-1.51,0-2.74-1.36-2.74-3.04 c0-1.68,1.23-3.04,2.74-3.04h43.35c1.51,0,2.74,1.36,2.74,3.04c0,1.68-1.23,3.04-2.74,3.04H16.83L16.83,102.11z M73.79,102.11 c-1.51,0-2.74-1.36-2.74-3.04c0-1.68,1.23-3.04,2.74-3.04h9.76c1.51,0,2.74,1.36,2.74,3.04c0,1.68-1.23,3.04-2.74,3.04H73.79 L73.79,102.11z M90.2,109.94c1.51,0.01,2.72,1.37,2.72,3.04c-0.01,1.67-1.23,3.02-2.74,3.02l-38.77-0.22 c-1.51-0.01-2.72-1.37-2.72-3.04c0.01-1.67,1.23-3.02,2.74-3.02L90.2,109.94L90.2,109.94z M38.86,109.71 c1.51,0,2.74,1.36,2.74,3.04c0,1.68-1.23,3.04-2.74,3.04h-7.72c-1.51,0-2.74-1.36-2.74-3.04c0-1.68,1.23-3.04,2.74-3.04H38.86 L38.86,109.71z");
    nightSVG.appendChild(nightPath);

    wrapper.appendChild(daySVG);
    wrapper.appendChild(nightSVG);
    document.body.appendChild(wrapper);

    wrapper.onclick = () => {
        if(document.body.classList.contains("night-mode")) {
            document.body.classList.remove("night-mode");
            document.cookie = "theme=light;";
        } else {
            document.body.classList.add("night-mode");
            document.cookie = "theme=dark;";
        }
    }
    wrapper.onkeyup = e => e.key === "Enter" && wrapper.onclick();
});